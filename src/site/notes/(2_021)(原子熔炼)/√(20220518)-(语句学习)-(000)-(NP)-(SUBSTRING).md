---
{"dg-publish":true,"permalink":"/2-021/20220518-000-np-substring/","dgHomeLink":true,"dgPassFrontmatter":false}
---


# <font color=#DC143C>(20220518)-(语句学习)-(000)-(NP)-(SUBSTRING)</font>
URL:: 

```
dataview
table without id 入榜亮点, 入榜输出
where contains(TITLES, "")
```

```
dataview
table without id 萃取函数, 萃取解法
where contains(TITLES, "")
```

```toc
```

## 00.Summary
1. 一般用法：`EXPRESSION`取值某个字段，起始位置`START`和截取长度`LENGTH`常量写死。
2. TALLY：`EXPRESSION`单次处理(变量传参或单个处理逻辑微观单元)写死，起始位置`START`引用辅助表TALLY，截取长度`LENGTH`常量写死。

## 01.Syntax
`SUBSTRING(EXPRESSION, START, LENGTH)`

## 02.Tally
### 0201.构建
```SQL
--⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶[DECLARE]
DECLARE @PARAMETER VARCHAR(8000);
--⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶[SET]
SET @PARAMETER = ',Element01,Element02,Element03,Element04,Element05,';
--⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶[CREATE]
IF OBJECT_ID('dbo.Tally', 'u') IS NOT NULL DROP TABLE dbo.Tally;
SELECT TOP 11000 IDENTITY(INT, 1, 1) AS N
INTO dbo.Tally
FROM master.dbo.syscolumns       AS a WITH(NOLOCK)
CROSS JOIN master.dbo.syscolumns AS b WITH(NOLOCK);
ALTER TABLE dbo.Tally ADD CONSTRAINT PK_Tally_N PRIMARY KEY CLUSTERED(N) WITH FILLFACTOR = 100;
GRANT SELECT, REFERENCES ON dbo.Tally TO PUBLIC;
--⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶[SUBSTRING]
SELECT N, SUBSTRING(@PARAMETER, N, 1)
FROM dbo.Tally
WHERE N <= LEN(@PARAMETER)
ORDER BY N;
```

### 0202.比较
```SQL
SELECT NAME,
       SUBSTRING(NAME, 1, 1) AS Initial,
       SUBSTRING(NAME, 3, 2) AS ThirdAndFourthCharacters
FROM sys.databases WITH(NOLOCK)
WHERE database_id < 5;
```